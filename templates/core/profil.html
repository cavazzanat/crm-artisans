<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profil entreprise - CRM Artisans</title>
    <style>
        /* ========================================
           VARIABLES & RESET
        ======================================== */
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --text: #1f2937;
            --text-light: #6b7280;
            --muted: #9ca3af;
            --border: #e5e7eb;
            --bg: #f9fafb;
            --card-bg: #ffffff;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
        }

        /* ========================================
           NAVIGATION
        ======================================== */
        .navbar {
            background: white;
            border-bottom: 1px solid var(--border);
            padding: 1rem 2rem;
            display: flex;
            align-items: center;
            gap: 2rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }

        .navbar-brand {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .navbar-nav {
            display: flex;
            gap: 1.5rem;
            list-style: none;
            align-items: center;
        }

        .navbar-nav a {
            color: var(--text);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.2s;
        }

        .navbar-nav a:hover,
        .navbar-nav a.active {
            color: var(--primary);
        }

        .navbar-user {
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .navbar-user span {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        /* ========================================
           CONTAINER
        ======================================== */
        .container {
            max-width: 1000px;
            margin: 2rem auto;
            padding: 0 2rem;
        }

        /* ========================================
           HEADER
        ======================================== */
        .page-header {
            margin-bottom: 2rem;
        }

        .page-header h1 {
            font-size: 1.75rem;
            color: var(--text);
            margin-bottom: 0.5rem;
        }

        .page-header p {
            color: var(--muted);
            margin: 0;
        }

        /* ========================================
           CARDS
        ======================================== */
        .card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }

        .card h3 {
            margin: 0 0 1.5rem 0;
            color: var(--text);
            font-size: 1.1rem;
            font-weight: 600;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid var(--border);
        }

        /* ========================================
           ALERTS
        ======================================== */
        .alert {
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 2rem;
        }

        .alert-warning {
            background: #fef3c7;
            border: 1px solid #fbbf24;
            color: #92400e;
        }

        .alert-warning strong {
            display: block;
            margin-bottom: 0.5rem;
        }

        .alert-success {
            background: #d1fae5;
            border: 1px solid #10b981;
            color: #065f46;
        }

        .alert-error {
            background: #fee2e2;
            border: 1px solid #ef4444;
            color: #991b1b;
        }

        /* ========================================
           FORMS
        ======================================== */
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }

        .form-grid-full {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            margin-bottom: 0.5rem;
            color: var(--text);
            font-weight: 500;
            font-size: 0.9rem;
        }

        .form-group label .required {
            color: var(--danger);
            margin-left: 0.25rem;
        }

        .form-group .help-text {
            margin-top: 0.25rem;
            font-size: 0.8rem;
            color: var(--muted);
        }

        .input,
        .select,
        textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 0.95rem;
            transition: all 0.2s;
            font-family: inherit;
        }

        .input:focus,
        .select:focus,
        textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        textarea {
            resize: vertical;
        }

        /* ========================================
           BUTTONS
        ======================================== */
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
            transition: all 0.2s;
            text-align: center;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
        }

        .btn-secondary {
            background: white;
            color: var(--text);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--bg);
        }

        .btn-container {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            margin-top: 2rem;
        }

        /* ========================================
           LOGO PREVIEW
        ======================================== */
        .logo-preview {
            margin-bottom: 1rem;
        }

        .logo-preview img {
            max-width: 200px;
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 0.5rem;
        }

        /* ========================================
           RESPONSIVE
        ======================================== */
        @media (max-width: 768px) {
            .navbar {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }

            .navbar-user {
                margin-left: 0;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .container {
                padding: 0 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- ========================================
         NAVIGATION
    ======================================== -->
    <nav class="navbar">
        <a href="{% url 'dashboard' %}" class="navbar-brand">
            üíº CRM Artisans
        </a>
        
        <ul class="navbar-nav">
            <li><a href="{% url 'dashboard' %}">Accueil</a></li>
            <li><a href="{% url 'operations' %}">Op√©rations</a></li>
            <li><a href="{% url 'clients' %}">Clients</a></li>
            <li><a href="{% url 'profil' %}" class="active">Profil</a></li>
        </ul>
        
            <div class="user">
                <span>{{ user.username }}</span>
                <form method="post" action="{% url 'logout' %}">
                {% csrf_token %}
                <button type="submit">D√©connexion</button>
                </form>
            </div>
    </nav>

    <!-- ========================================
         CONTAINER
    ======================================== -->
    <div class="container">
        <!-- Header -->
        <div class="page-header">
            <h1>‚öôÔ∏è Profil entreprise</h1>
            <p>Renseignez les informations de votre entreprise pour g√©n√©rer vos devis et factures</p>
        </div>
        
        <!-- Alert si profil incomplet -->
        {% if not profil.est_complet %}
        <div class="alert alert-warning">
            <strong>‚ö†Ô∏è Profil incomplet</strong>
            Certaines informations obligatoires sont manquantes. Compl√©tez votre profil pour pouvoir g√©n√©rer des devis professionnels.
        </div>
        {% endif %}
        
        <!-- Messages Django -->
        {% if messages %}
            {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">
                {{ message }}
            </div>
            {% endfor %}
        {% endif %}
        
        <!-- Formulaire -->
        <form method="POST" enctype="multipart/form-data">
            {% csrf_token %}
            
            <!-- ========================================
                IDENTIFICATION ENTREPRISE
            ======================================== -->
            <div class="card">
                <h3>üìã Identification de l'entreprise</h3>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="nom_entreprise">
                            Nom de l'entreprise / Raison sociale
                            <span class="required">*</span>
                        </label>
                        <input type="text" 
                               id="nom_entreprise" 
                               name="nom_entreprise" 
                               class="input" 
                               value="{{ profil.nom_entreprise }}"
                               required>
                    </div>
                    
                    <div class="form-group">
                        <label for="forme_juridique">Forme juridique</label>
                        <select id="forme_juridique" name="forme_juridique" class="select">
                            <option value="">-- S√©lectionner --</option>
                            {% for value, label in formes_juridiques %}
                            <option value="{{ value }}" {% if profil.forme_juridique == value %}selected{% endif %}>
                                {{ label }}
                            </option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
                
                <div class="form-grid" style="margin-top: 1.5rem;">
                    <div class="form-group">
                        <label for="siret">
                            N¬∞ SIRET
                            <span class="required">*</span>
                        </label>
                        <input type="text" 
                               id="siret" 
                               name="siret" 
                               class="input" 
                               value="{{ profil.siret }}"
                               placeholder="12345678900012"
                               maxlength="14"
                               required>
                    </div>
                    
                    <div class="form-group">
                        <label for="code_ape">Code APE/NAF</label>
                        <input type="text" 
                               id="code_ape" 
                               name="code_ape" 
                               class="input" 
                               value="{{ profil.code_ape }}"
                               placeholder="Ex: 4332A">
                    </div>
                </div>
                
                <div class="form-grid" style="margin-top: 1.5rem;">
                    <div class="form-group">
                        <label for="rcs">N¬∞ RCS + Ville</label>
                        <input type="text" 
                               id="rcs" 
                               name="rcs" 
                               class="input" 
                               value="{{ profil.rcs }}"
                               placeholder="Ex: RCS Paris 123 456 789">
                        <span class="help-text">Obligatoire pour les soci√©t√©s (SARL, SAS, etc.)</span>
                    </div>
                    
                    <div class="form-group">
                        <label for="capital_social">Capital social (‚Ç¨)</label>
                        <input type="number" 
                               id="capital_social" 
                               name="capital_social" 
                               class="input" 
                               value="{{ profil.capital_social|default:'' }}"
                               step="0.01"
                               placeholder="Ex: 5000">
                    </div>
                </div>
                
                <div class="form-grid-full" style="margin-top: 1.5rem;">
                    <div class="form-group">
                        <label for="tva_intracommunautaire">N¬∞ TVA intracommunautaire</label>
                        <input type="text" 
                               id="tva_intracommunautaire" 
                               name="tva_intracommunautaire" 
                               class="input" 
                               value="{{ profil.tva_intracommunautaire }}"
                               placeholder="Ex: FR12345678901">
                    </div>
                </div>
            </div>
            
            <!-- ========================================
                ADRESSE
            ======================================== -->
            <div class="card">
                <h3>üìç Adresse du si√®ge social</h3>
                
                <div class="form-grid-full">
                    <div class="form-group">
                        <label for="adresse">
                            Adresse
                            <span class="required">*</span>
                        </label>
                        <textarea id="adresse" 
                                  name="adresse" 
                                  class="input" 
                                  rows="2"
                                  required>{{ profil.adresse }}</textarea>
                    </div>
                </div>
                
                <div class="form-grid" style="margin-top: 1.5rem;">
                    <div class="form-group">
                        <label for="code_postal">Code postal</label>
                        <input type="text" 
                               id="code_postal" 
                               name="code_postal" 
                               class="input" 
                               value="{{ profil.code_postal }}"
                               placeholder="Ex: 75010">
                    </div>
                    
                    <div class="form-group">
                        <label for="ville">Ville</label>
                        <input type="text" 
                               id="ville" 
                               name="ville" 
                               class="input" 
                               value="{{ profil.ville }}"
                               placeholder="Ex: Paris">
                    </div>
                </div>
            </div>
            
            <!-- ========================================
                COORDONN√âES
            ======================================== -->
            <div class="card">
                <h3>üìû Coordonn√©es professionnelles</h3>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="telephone">
                            T√©l√©phone
                            <span class="required">*</span>
                        </label>
                        <input type="tel" 
                               id="telephone" 
                               name="telephone" 
                               class="input" 
                               value="{{ profil.telephone }}"
                               placeholder="Ex: 01 23 45 67 89"
                               required>
                    </div>
                    
                    <div class="form-group">
                        <label for="email">
                            Email
                            <span class="required">*</span>
                        </label>
                        <input type="email" 
                               id="email" 
                               name="email" 
                               class="input" 
                               value="{{ profil.email }}"
                               placeholder="Ex: contact@entreprise.fr"
                               required>
                    </div>
                </div>
                
                <div class="form-grid-full" style="margin-top: 1.5rem;">
                    <div class="form-group">
                        <label for="site_web">Site web</label>
                        <input type="url" 
                               id="site_web" 
                               name="site_web" 
                               class="input" 
                               value="{{ profil.site_web }}"
                               placeholder="Ex: https://www.monentreprise.fr">
                    </div>
                </div>
            </div>
            
            <!-- ========================================
                ASSURANCE D√âCENNALE
            ======================================== -->
            <div class="card">
                <h3>üõ°Ô∏è Assurance d√©cennale</h3>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="assurance_decennale_nom">Nom de l'assureur</label>
                        <input type="text" 
                               id="assurance_decennale_nom" 
                               name="assurance_decennale_nom" 
                               class="input" 
                               value="{{ profil.assurance_decennale_nom }}"
                               placeholder="Ex: AXA, Allianz, MAAF">
                    </div>
                    
                    <div class="form-group">
                        <label for="assurance_decennale_numero">N¬∞ de police</label>
                        <input type="text" 
                               id="assurance_decennale_numero" 
                               name="assurance_decennale_numero" 
                               class="input" 
                               value="{{ profil.assurance_decennale_numero }}"
                               placeholder="Ex: 987654321">
                    </div>
                </div>
                
                <div class="form-grid" style="margin-top: 1.5rem;">
                    <div class="form-group">
                        <label for="assurance_decennale_validite">Date de validit√©</label>
                        <input type="date" 
                               id="assurance_decennale_validite" 
                               name="assurance_decennale_validite" 
                               class="input" 
                               value="{% if profil.assurance_decennale_validite %}{{ profil.assurance_decennale_validite|date:'Y-m-d' }}{% endif %}">
                    </div>
                </div>
            </div>
            
            <!-- ========================================
                QUALIFICATIONS
            ======================================== -->
            <div class="card">
                <h3>üèÜ Qualifications et certifications</h3>
                
                <div class="form-grid-full">
                    <div class="form-group">
                        <label for="qualifications">Qualifications</label>
                        <textarea id="qualifications" 
                                  name="qualifications" 
                                  class="input" 
                                  rows="3"
                                  placeholder="Ex: RGE, Qualibat, etc.">{{ profil.qualifications }}</textarea>
                        <span class="help-text">Listez vos certifications et qualifications professionnelles</span>
                    </div>
                </div>
            </div>
            
            <!-- ========================================
                INFORMATIONS BANCAIRES
            ======================================== -->
            <div class="card">
                <h3>üí≥ Informations bancaires</h3>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="iban">IBAN</label>
                        <input type="text" 
                               id="iban" 
                               name="iban" 
                               class="input" 
                               value="{{ profil.iban }}"
                               placeholder="Ex: FR76 1234 5678 9012 3456 7890 123">
                    </div>
                    
                    <div class="form-group">
                        <label for="bic">BIC/SWIFT</label>
                        <input type="text" 
                               id="bic" 
                               name="bic" 
                               class="input" 
                               value="{{ profil.bic }}"
                               placeholder="Ex: BNPAFRPP">
                    </div>
                </div>
            </div>
            
            <!-- ========================================
                MENTIONS L√âGALES
            ======================================== -->
            <div class="card">
                <h3>üìÑ Mentions l√©gales du devis</h3>
                
                <div class="form-grid-full">
                    <div class="form-group">
                        <label for="mentions_legales_devis">Mentions l√©gales</label>
                        <textarea id="mentions_legales_devis" 
                                  name="mentions_legales_devis" 
                                  class="input" 
                                  rows="5"
                                  placeholder="Ex: Conditions de paiement, p√©nalit√©s de retard, etc.">{{ profil.mentions_legales_devis }}</textarea>
                        <span class="help-text">Ce texte appara√Ætra en bas de vos devis (conditions de paiement, clause de r√©vision des prix, etc.)</span>
                    </div>
                </div>
            </div>
            
            <!-- ========================================
                LOGO
            ======================================== -->
            <div class="card">
                <h3>üé® Logo de l'entreprise</h3>
                
                {% if profil.logo %}
                <div class="logo-preview">
                    <img src="{{ profil.logo.url }}" alt="Logo">
                </div>
                {% endif %}
                
                <div class="form-grid-full">
                    <div class="form-group">
                        <label for="logo">{% if profil.logo %}Changer le logo{% else %}Ajouter un logo{% endif %}</label>
                        <input type="file" 
                               id="logo" 
                               name="logo" 
                               class="input" 
                               accept="image/*">
                        <span class="help-text">Format recommand√© : PNG avec fond transparent, 500x200px</span>
                    </div>
                </div>
            </div>
            
            <!-- ========================================
                BOUTONS
            ======================================== -->
            <div class="btn-container">
                <a href="{% url 'dashboard' %}" class="btn btn-secondary">Annuler</a>
                <button type="submit" class="btn btn-primary">üíæ Enregistrer le profil</button>
            </div>
        </form>
    </div>
</body>
</html>