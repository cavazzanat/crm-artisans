<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{% if is_edit %}Modifier{% else %}Nouveau{% endif %} Client – CRM Artisans</title>
  <style>
    :root{
      --bg: #0b1220;
      --card: #0f172a;
      --muted: #94a3b8;
      --text: #e2e8f0;
      --primary: #6366f1;
      --success: #22c55e;
      --warning: #f59e0b;
      --danger: #ef4444;
      --accent: #8b5cf6;
      --ring: rgba(99,102,241,.35);
      --border: rgba(148,163,184,.15);
      --shadow: 0 10px 25px rgba(2,6,23,.3), 0 1px 0 rgba(255,255,255,.03) inset;

      --bg-light: #f8fafc;
      --card-light: #ffffff;
      --text-light: #1e293b;
      --muted-light: #64748b;
      --border-light: rgba(30,41,59,.12);
      --shadow-light: 0 10px 25px rgba(30,41,59,.08), 0 1px 0 rgba(255,255,255,.8) inset;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: radial-gradient(1200px 800px at 20% -10%, rgba(99,102,241,.12), transparent 40%),
                  radial-gradient(1000px 600px at 80% 10%, rgba(139,92,246,.12), transparent 40%),
                  var(--bg);
      color: var(--text);
      line-height: 1.5;
    }

    /* Header harmonisé */
    .header{ 
      position: sticky; top: 0; z-index: 40; 
      backdrop-filter: saturate(180%) blur(8px); 
      background: linear-gradient(180deg, rgba(15,23,42,.85), rgba(15,23,42,.65)); 
      border-bottom: 1px solid var(--border) 
    }
    .header-inner{ 
      max-width:1280px; margin:0 auto; padding:.85rem 1rem; 
      display:flex; align-items:center; gap:1rem; justify-content:space-between 
    }
    .brand{ display:flex; align-items:center; gap:.75rem; font-weight:700; letter-spacing:.2px }
    .logo{ 
      width:34px; height:34px; border-radius:10px; 
      background:linear-gradient(145deg, var(--primary), var(--accent)); 
      box-shadow: var(--shadow); display:grid; place-items:center 
    }
    .logo svg{ width:18px; height:18px; color:white }
    .nav-menu{ display:flex; gap:.25rem; align-items:center }
    .nav-menu a{ 
      text-decoration:none; color:var(--muted); padding:.55rem .8rem; 
      border-radius:10px; border:1px solid transparent 
    }
    .nav-menu a:hover{ color:var(--text); background:rgba(148,163,184,.08); border-color:var(--border) }
    .nav-menu a.active{ 
      color:white; background:rgba(99,102,241,.18); 
      border-color: rgba(99,102,241,.35); box-shadow: 0 0 0 2px var(--ring) 
    }
    .user-info{ display:flex; align-items:center; gap:.75rem; color:var(--muted); font-size:.95rem }
    .user-info form button{ 
      background:none; border:none; color:var(--muted); cursor:pointer; 
      text-decoration:underline; font:inherit 
    }

    /* Main harmonisé */
    .container{ max-width:800px; margin: 2rem auto; padding: 0 1rem }
    .breadcrumb{ color:var(--muted); font-size:.9rem; margin-bottom: 1rem }
    .breadcrumb a{ color:var(--muted); text-decoration:none }
    .breadcrumb a:hover{ color:var(--text) }

    /* Form card harmonisée */
    .form-card{ 
      background: linear-gradient(180deg, rgba(2,6,23,.6), rgba(2,6,23,.4)); 
      border:1px solid var(--border); border-radius:16px; 
      box-shadow: var(--shadow); overflow:hidden;
    }
    
    .form-header{ 
      padding:1.5rem; border-bottom:1px solid var(--border); 
      background: linear-gradient(180deg, rgba(15,23,42,.8), rgba(15,23,42,.6));
    }
    .form-header h2{ margin:0; color:var(--text); font-weight:700; font-size:1.25rem }
    
    .form-content{ padding:2rem }

    /* Form harmonisé */
    .form-group{ display:flex; flex-direction:column; gap:.4rem; margin-bottom: 1.5rem }
    .form-group label{ color:var(--muted); font-size:.9rem; font-weight:600 }
    .required::after{ content: ' *'; color: var(--danger); font-weight:700 }
    
    .form-group input{ 
      width:100%; padding:.75rem .8rem; border-radius:10px; 
      border:1px solid var(--border); background: rgba(2,6,23,.35); 
      color: var(--text); font:inherit; font-size:1rem;
    }
    .form-group input::placeholder{ color: rgba(226,232,240,.55) }
    .form-group input:focus{ 
      outline:none; box-shadow: 0 0 0 2px var(--ring); 
      border-color: rgba(99,102,241,.35) 
    }

    .form-row{ display:grid; grid-template-columns: 1fr 1fr; gap:1rem }

    /* Buttons harmonisés */
    .btn{ 
      display:inline-flex; align-items:center; gap:.5rem; padding:.75rem 1.5rem; 
      border-radius:10px; border:1px solid var(--border); 
      background:rgba(148,163,184,.07); color:var(--text); 
      text-decoration:none; cursor:pointer; font:inherit; margin-right: .5rem;
      font-size:1rem;
    }
    .btn:hover{ background:rgba(148,163,184,.12) }
    .btn-outline{ 
      background: rgba(148,163,184,.07); 
      border-color: var(--border); 
      color: var(--text) 
    }
    .btn-outline:hover{ background: rgba(148,163,184,.12) }
    
    /* Button par défaut (créer/modifier) */
    .btn:not(.btn-outline){
      background:linear-gradient(180deg, rgba(34,197,94,.18), rgba(34,197,94,.12)); 
      border-color: rgba(34,197,94,.35); color: white 
    }

    /* Messages */
    .alert{ 
      padding: .75rem 1rem; border-radius: 10px; margin-bottom: 1rem; 
      border: 1px solid; display: flex; align-items: center; gap: .5rem;
    }
    .alert-success{ 
      color: var(--success); background: rgba(34,197,94,.1); 
      border-color: rgba(34,197,94,.2); 
    }
    .alert-error{ 
      color: var(--danger); background: rgba(239,68,68,.1); 
      border-color: rgba(239,68,68,.2); 
    }

    /* Actions footer */
    .form-actions{
      text-align: right; 
      margin-top: 2rem; 
      padding-top: 1.5rem; 
      border-top: 1px dashed var(--border);
    }

    /* Responsive */
    @media (max-width: 780px){
      .header-inner{ flex-direction: column; gap: 1rem }
      .nav-menu{ gap: 1rem }
      .form-row{ grid-template-columns: 1fr }
      .form-actions{ 
        text-align: center; 
        display: flex; 
        flex-direction: column-reverse; 
        gap: 1rem; 
      }
      .form-actions .btn{ margin: 0; width: 100%; justify-content: center; }
    }

    /* Light mode harmonisé */
    @media (prefers-color-scheme: light){
      :root{ 
        --bg: var(--bg-light); 
        --card: var(--card-light); 
        --text: var(--text-light); 
        --muted: var(--muted-light); 
        --border: var(--border-light); 
        --shadow: var(--shadow-light);
      }
      
      body{ 
        background: radial-gradient(1200px 800px at 20% -10%, rgba(99,102,241,.05), transparent 40%), 
                    radial-gradient(1000px 600px at 80% 10%, rgba(139,92,246,.05), transparent 40%), 
                    var(--bg) 
      }
      
      .header{ 
        background: linear-gradient(180deg, rgba(255,255,255,.9), rgba(255,255,255,.8));
        backdrop-filter: saturate(180%) blur(8px);
      }
      
      .form-card{ 
        background: var(--card); 
        border: 1px solid var(--border);
        box-shadow: var(--shadow);
      }
      
      .form-header{
        background: linear-gradient(180deg, rgba(248,250,252,.9), rgba(248,250,252,.8));
        border-bottom: 1px solid var(--border);
      }
      
      .form-group input{ 
        background: #fff; 
        border-color: var(--border); 
        color: var(--text) 
      }
      .form-group input::placeholder{ color: rgba(100,116,139,.6) }
      
      .nav-menu a{ color: var(--muted) }
      .nav-menu a:hover{ color: var(--text) }
      .nav-menu a.active{ 
        color: var(--primary); 
        background: rgba(99,102,241,.08); 
        border-color: rgba(99,102,241,.2) 
      }
      
      .user-info{ color: var(--muted) }
      .user-info form button{ color: var(--muted) }
      
      .btn{ 
        background: rgba(148,163,184,.06); 
        color: var(--text);
      }
      .btn:hover{ background: rgba(148,163,184,.1) }
      
      .btn-outline{ 
        background: rgba(148,163,184,.06); 
        color: var(--text);
      }
      .btn-outline:hover{ background: rgba(148,163,184,.1) }
      
      .btn:not(.btn-outline){ 
        background: rgba(34,197,94,.1); 
        border-color: rgba(34,197,94,.2);
        color: #16a34a;
      }
    }
  </style>
</head>
<body>
  <header class="header">
    <div class="header-inner">
      <div class="brand">
        <div class="logo" aria-hidden="true">
          <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M4 14.5 12 4l8 10.5-8 5.5-8-5.5Z" stroke="currentColor" stroke-width="1.6"/>
          </svg>
        </div>
        <span>CRM Artisans</span>
      </div>
      <nav class="nav-menu" aria-label="Navigation principale">
        <a href="{% url 'dashboard' %}">Accueil</a>
        <a href="{% url 'operations' %}">Opérations</a>
        <a href="{% url 'clients' %}" class="active">Clients</a>
      </nav>
      <div class="user-info">
        <span>Connecté : {{ user.username }}</span>
        <form method="post" action="{% url 'logout' %}" style="display: inline; margin: 0;">
          {% csrf_token %}
          <button type="submit" title="Se déconnecter">Déconnexion</button>
        </form>
      </div>
    </div>
  </header>

  <main class="container">
    <div class="breadcrumb">
      <a href="{% url 'dashboard' %}">Accueil</a> / 
      <a href="{% url 'clients' %}">Clients</a> / 
      {% if is_edit %}Modifier {{ client.nom }}{% else %}Nouveau client{% endif %}
    </div>

    <!-- Messages -->
    {% if messages %}
      {% for message in messages %}
      <div class="alert alert-{{ message.tags }}">
        {% if message.tags == 'success' %}
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="m5 12 4 4 10-10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        {% else %}
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="M12 9v4M12 17h0" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        {% endif %}
        {{ message }}
      </div>
      {% endfor %}
    {% endif %}

    <div class="form-card">
      <div class="form-header">
        <h2>{% if is_edit %}Modifier le client{% else %}Nouveau client{% endif %}</h2>
      </div>
      
      <div class="form-content">
        <form method="POST">
          {% csrf_token %}
          
          <div class="form-row">
            <div class="form-group">
              <label for="nom" class="required">Nom</label>
              <input type="text" id="nom" name="nom" value="{{ nom }}" required>
            </div>
            <div class="form-group">
              <label for="prenom">Prénom</label>
              <input type="text" id="prenom" name="prenom" value="{{ prenom }}">
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label for="telephone" class="required">Téléphone</label>
              <input type="tel" id="telephone" name="telephone" value="{{ telephone }}" required>
            </div>
            <div class="form-group">
              <label for="email">Email</label>
              <input type="email" id="email" name="email" value="{{ email }}">
            </div>
          </div>
          
          <div class="form-group">
            <label for="adresse">Adresse</label>
            <input type="text" id="adresse" name="adresse" value="{{ adresse }}">
          </div>
          
          <div class="form-group">
            <label for="ville">Ville</label>
            <input type="text" id="ville" name="ville" value="{{ ville }}">
          </div>
          
          <div class="form-actions">
            <a href="{% if is_edit %}{% url 'client_detail' client.id %}{% else %}{% url 'clients' %}{% endif %}" 
               class="btn btn-outline">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="M19 12H5M12 19l-7-7 7-7" stroke="currentColor" stroke-width="1.5"/></svg>
              Annuler
            </a>
            <button type="submit" class="btn">
              {% if is_edit %}
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="M12 20h9M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z" stroke="currentColor" stroke-width="1.5"/></svg>
                Modifier
              {% else %}
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="m5 12 4 4 10-10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
                Créer
              {% endif %}
              le client
            </button>
          </div>
        </form>
      </div>
    </div>
  </main>

{% if messages %}
{% for message in messages %}
<div class="alert {{ message.tags }}">
  {{ message }}
</div>
{% endfor %}

<script>
setTimeout(function() {
  document.querySelectorAll('.alert').forEach(el => el.remove());
}, 3000); // 3 secondes
</script>
{% endif %}
</body>
</html>